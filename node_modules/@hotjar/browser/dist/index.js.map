{"version":3,"file":"index.js","sources":["../src/utils.ts","../src/index.ts"],"sourcesContent":["type HotjarCommand = 'event' | 'identify' | 'stateChange';\n\nexport type InitOpts = {\n  debug?: boolean,\n  nonce?: string,\n};\n\nexport interface WindowWithHotjar extends Window {\n  hj?: (method: HotjarCommand, ...data: unknown[]) => void;\n}\n\ndeclare const window: WindowWithHotjar;\n\nconst hasWindow = () => typeof window !== 'undefined';\n\nexport const checkReadyState = (): boolean => {\n  if (hasWindow() && window.hj) {\n    return true;\n  }\n\n  return false;\n};\n\nexport const executeHotjarCommand = (command: HotjarCommand, ...args: unknown[]): void => {\n  if (hasWindow() && window.hj) {\n    return window.hj(command, ...args);\n  }\n\n  throw Error('Hotjar is not available, make sure init has been called.');\n};\n\nconst appendScript = (scriptText: string, scriptId: string, nonce: undefined | string = undefined): boolean => {\n  try {\n    const existingScript = document.getElementById(scriptId) as HTMLScriptElement;\n    const script = existingScript || document.createElement('script');\n    script.id = scriptId;\n    script.nonce = nonce;\n    script.innerText = scriptText;\n    script.crossOrigin = 'anonymous';\n\n    document.head.appendChild(script);\n    return true;\n  } catch {\n    return false;\n  }\n};\n\nexport const initScript = (\n  hotjarId: number,\n  hotjarVersion: number, \n  opts?: InitOpts\n): void => {\n  const isDebug = opts?.debug || false;\n\n  const hotjarScriptCode = `(function(h,o,t,j,a,r){h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};h._hjSettings={hjid:${hotjarId},hjsv:${hotjarVersion},hjdebug:${isDebug}};a=o.getElementsByTagName('head')[0];r=o.createElement('script');r.async=1;r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;a.appendChild(r);})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');`;\n  const isAppended = appendScript(hotjarScriptCode, 'hotjar-init-script', opts?.nonce);\n  if (isAppended && checkReadyState()) {\n    return;\n  }\n  throw Error('Failed to initialize Hotjar tracking script.');\n};\n","import { checkReadyState, initScript, executeHotjarCommand } from './utils';\nimport type { InitOpts } from './utils';\n\ntype UserInfo = Record<string | number, string | number | Date | boolean>;\n\nconst Hotjar = {\n  init: (hotjarId: number, hotjarVersion: number, opts?: InitOpts): boolean => {\n    try {\n      initScript(hotjarId, hotjarVersion, opts);\n      return true;\n    } catch (error) {\n      console.error('Error:', error);\n      return false;\n    }\n  },\n  event: (actionName: string): boolean => {\n    try {\n      executeHotjarCommand('event', actionName);\n      return true;\n    } catch (error) {\n      console.error('Error:', error);\n      return false;\n    }\n  },\n  identify: (userId: string | null, userInfo: UserInfo): boolean => {\n    try {\n      executeHotjarCommand('identify', userId, userInfo);\n      return true;\n    } catch (error) {\n      console.error('Error:', error);\n      return false;\n    }\n  },\n  stateChange: (relativePath: string): boolean => {\n    try {\n      executeHotjarCommand('stateChange', relativePath);\n      return true;\n    } catch (error) {\n      console.error('Error:', error);\n      return false;\n    }\n  },\n  isReady: checkReadyState,\n};\n\nexport default Hotjar;\n"],"names":["hasWindow","window","checkReadyState","hj","executeHotjarCommand","command","args","Error","initScript","hotjarId","hotjarVersion","opts","scriptText","scriptId","nonce","script","document","getElementById","createElement","id","innerText","crossOrigin","head","appendChild","appendScript","debug","Hotjar","init","error","console","event","actionName","identify","userId","userInfo","stateChange","relativePath","isReady"],"mappings":"oEAaA,MAAMA,EAAY,IAAwB,oBAAXC,OAElBC,EAAkB,OACzBF,MAAeC,OAAOE,IAOfC,EAAuB,CAACC,KAA2BC,KAC9D,GAAIN,KAAeC,OAAOE,GACxB,OAAOF,OAAOE,GAAGE,KAAYC,GAG/B,MAAMC,MAAM,6DAmBDC,EAAa,CACxBC,EACAC,EACAC,KAMA,IAzBmB,EAACC,EAAoBC,EAAkBC,KAC1D,IACE,MACMC,EADiBC,SAASC,eAAeJ,IACdG,SAASE,cAAc,UAOxD,OANAH,EAAOI,GAAKN,EACZE,EAAOD,MAAQA,EACfC,EAAOK,UAAYR,EACnBG,EAAOM,YAAc,YAErBL,SAASM,KAAKC,YAAYR,IACnB,EACP,SACA,OAAO,IAYUS,CADM,yGAAyGf,UAAiBC,cAFnIC,MAAAA,SAAAA,EAAMc,SAAS,qNAGmB,qBAAsBd,MAAAA,SAAAA,EAAMG,SAC5DZ,IAGlB,MAAMK,MAAM,iDCtDRmB,EAAS,CACbC,KAAM,CAAClB,EAAkBC,EAAuBC,KAC9C,IAEE,OADAH,EAAWC,EAAUC,EAAeC,IAC7B,EACP,MAAOiB,GAEP,OADAC,QAAQD,MAAM,SAAUA,IACjB,IAGXE,MAAQC,IACN,IAEE,OADA3B,EAAqB,QAAS2B,IACvB,EACP,MAAOH,GAEP,OADAC,QAAQD,MAAM,SAAUA,IACjB,IAGXI,SAAU,CAACC,EAAuBC,KAChC,IAEE,OADA9B,EAAqB,WAAY6B,EAAQC,IAClC,EACP,MAAON,GAEP,OADAC,QAAQD,MAAM,SAAUA,IACjB,IAGXO,YAAcC,IACZ,IAEE,OADAhC,EAAqB,cAAegC,IAC7B,EACP,MAAOR,GAEP,OADAC,QAAQD,MAAM,SAAUA,IACjB,IAGXS,QAASnC"}